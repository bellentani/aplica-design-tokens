# Aplica Theme Engine - Technical Reference

## Glossary of Terms

### **Design Tokens**
Design values stored as data (JSON) that represent fundamental visual decisions such as colors, typography, spacing.

### **SSoT (Single Source of Truth)**
Centralized Git repository containing all JSON files that define tokens. Single authorized source for changes.

### **Factory (_primitive-theme)**
Automated system that generates color palettes ensuring accessibility through contrast and harmony algorithms. Used by brands that use our token generation API.

### **Transformer**
Process that converts JSON tokens into consumable formats (CSS, XML, Swift, etc.) using Style Dictionary or similar.

### **Surface**
Visual hierarchy context based on photographic analogy - positive (normal) vs negative (inverted).

### **Semantic Layer**
Layer that consolidates all previous transformations, giving specific purpose to tokens for interface use.

### **Theme Set**
Configuration in Tokens Studio that defines which JSON files compose a specific theme.

### **Tokens Studio Native**
Native Tokens Studio system that uses its own mathematics and calculations for token generation. Used by Joy brand.

## Formulas and Systems

### **Dimensional System - Adapted Fibonacci**

#### Rules:
1. Base: 16px (1 design unit)
2. Minimum unit: 4px (1 layout unit)
3. Progression: Modified Fibonacci

#### Scale:
```
0, 1, 2, 4, 8, 12, 16, 20, 24, 28, 44, 72, 116
```

#### Application:
- **Sizing**: Includes 1 and 2 for thin borders
- **Spacing**: Minimum 4px for distances

### **Line Height System**

#### Formula:
```
lineHeight = ROUNDUP((fontSize × multiplier) / 4) × 4
```

#### Multipliers:
- **Tight**: 1.0 (100%)
- **Close**: 1.2 (120%)
- **Regular**: 1.4 (140%)
- **Wild**: 1.8 (180%)

#### Example:
```
fontSize: 14px
multiplier: 1.2 (close)
calculation: 14 × 1.2 = 16.8
rounding: ROUNDUP(16.8/4) × 4 = 20px
```

### **Opacity System**

#### Hexadecimal values:
```
Transparent:      #RRGGBB00 (0%)
SuperTransparent: #RRGGBB1A (10%)
SemiTranslucid:   #RRGGBB33 (20%)
Translucid:       #RRGGBB80 (50%)
SuperTranslucid:  #RRGGBBCC (80%)
SemiOpaque:       #RRGGBBE6 (90%)
Opaque:           #RRGGBB   (100%)
```

### **Surface Inversion (Positive ↔ Negative)**

#### Intensities (3 levels):
```
lowest  ↔ highest
default ↔ default
highest ↔ lowest
```

#### Scales (7 levels):
```
lowest  ↔ highest
lower   ↔ higher
low     ↔ high
mid     ↔ mid
high    ↔ low
higher  ↔ lower
highest ↔ lowest
```

## Token Structure

### **Token Type ($type)**
```json
{
  "$type": "color",     // Token type
  "$value": "#FF6B00"   // Token value
}
```

### **References ($value with {})**
```json
{
  "$value": "{semantic.color.brand.primary}" // References another token
}
```

### **Structural Tokens (underscore)**
- `_primitive-theme-default`: Generated by API (used by Tangerine and Grinch)
- `_primitive-theme-default-config`: API configuration
- `_color-palette`: Color factory
- `_theme-*`: Reusable base systems
- `_other-elements`: Tokens Studio specific elements (used by Joy)
- Don't participate in main transformation chain

## APIs and Integrations

### **Style Dictionary**
```javascript
// Basic configuration
module.exports = {
  source: ['tokens/**/*.json'],
  platforms: {
    css: {
      transformGroup: 'css',
      files: [{
        destination: 'variables.css',
        format: 'css/variables'
      }]
    }
  }
}
```

### **Tokens Studio for Figma**
```json
{
  "themes": {
    "ze-light-positive": {
      "selectedTokenSets": {
        "theme/ze/_brand": "enabled",
        "dimension/normal": "source"
      }
    }
  }
}
```

### **CI/CD Pipeline**
```yaml
# GitHub Actions example
on:
  push:
    paths:
      - 'tokens/**/*.json'
jobs:
  build:
    steps:
      - run: npm run validate:tokens
      - run: npm run build:tokens
      - run: npm run sync:figma
```

## Naming Patterns

### **Tokens**
- **Hierarchical**: `semantic.color.interface.feedback.success`
- **Camel case**: `fontSizes`, `lineHeights`
- **Ordinal for brand**: `first`, `second`, `third`
- **Intensity**: `lowest`, `default`, `highest`

### **Files**
- **Underscore**: `_brand.json` (structural)
- **Kebab case**: `light-positive.json`
- **Grouping**: `theme/ze/`, `mode/`

### **Final themes**
```
theme_[brand]_[mode]_[surface]_[density]
theme_ze_light_positive_normal
```

## Limits and Constraints

### **Performance**
- Maximum build time: 60s for 10 brands
- Size per theme: < 100KB
- Maximum reference depth: 10 levels

### **Scalability**
- Practical maximum: 50 brands × 4 modes × 4 surfaces
- Beyond that, consider distributed architecture

### **Compatibility**
- Tokens Studio: v0.11+
- Style Dictionary: v3.0+
- Node.js: 16+

## Links for Details

### **Specifications**
- [W3C Design Tokens Format](https://tr.designtokens.org/format/)
- [Style Dictionary Docs](https://amzn.github.io/style-dictionary/)
- [Tokens Studio Transform](https://docs.tokens.studio/transform-tokens)

### **Tools**
- [Contrast Checker](https://webaim.org/resources/contrastchecker/)
- [Figma Tokens Plugin](https://www.figma.com/community/plugin/843461159747178978)
- [Token Transformer](https://transform.tokens.studio/)

### **Internal Documentation**
- Complete Architecture: `theme_engine_architecture_doc.md`
- Design Rationales: `tokens_tamanho_espacamento.md`
- Typography: `tokens_tipografia_fontes.md`

---

*This technical reference serves as a quick consultation for Aplica Theme Engine implementers and maintainers.* 