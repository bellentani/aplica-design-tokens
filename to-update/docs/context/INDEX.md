# Context Index - RAG-Optimized

**Project**: Design Tokens System
**Version**: 2.15.2
**Last Updated**: February 2026
**Purpose**: Quick reference for AI Agents and Developers to locate specific project knowledge.

---

## ðŸ“ Navigation Reference

### 1. ðŸ›‘ Essential Context (Root)

*   **`AI_CONTEXT.md`**: The master entry point.
*   **`docs/context/AGENT_GUIDE.md`**: Operational rules for agents.
*   **`docs/context/RULES.md`**: Project Constitution and Constraints.

### 2. ðŸ§  Project State (docs/context/)

*   **`SUMMARY.md`**: High-level project status and overview.
*   **`WORK_PLAN.md`**: Detailed changelog and active work streams.
*   **`RELEASE_FILES.md`**: Modified files per version (for forks, other teams, and IA-assisted upgrades).
*   **`docs/CHANGELOG-ARCHIVE.md`**: Full changelog entries for 2.11.x and below (main CHANGELOG is compact).
*   **`UPDATE_BUNDLES_GUIDE.md`**: How to create and apply update bundles for projects based on this structure (file list, change summary, apply steps; avoid breakage).
*   **`DYNAMIC_THEMES.md`**: Specifics on the theme generation engine.
*   **`THEME_CONFIG_REFERENCE.md`**: Quick reference for all theme config options; template with examples: `dynamic-themes/configs/theme-engine.config.mjs`.
*   **`BUILD_SYSTEM_UPDATE.md`**: History and context of the build/transform system.
*   **`DIST_STRUCTURE_FIX.md`**: Context on the output folder structure decision.
*   **`TOKENS_REPO_AND_COMPONENT_LIBRARIES_PLAN.md`**: **Future work** â€“ Plan for publishing tokens as a separate consumable package and integrating with component libraries (React, Vue, Flutter, etc.); CONSUMER.md, contract, and optional Component As Data.
*   **`docs/context/tokens/token-usage-for-components-and-figma.md`**: Token usage for components and Figma (Semantic vs Foundation; how to recognize tokens in design files).

### 3. ðŸ“š Technical Documentation (docs/ & others)

*   **`transformers/SIMPLIFIED-ARCHITECTURE.md`**: Deep dive into the build system logic.
*   **`dynamic-themes/README.md`**: Deep dive into the generator logic.
*   **`transformers/TESTING.md`**: Guide to the testing suite.
*   **`docs/en/#11 Theme Engine - Gradient Configuration.md`**: Full gradient configuration guide (EN).
*   **`docs/pt-br/#11 Theme Engine - ConfiguraÃ§Ã£o de Gradientes.md`**: Full gradient configuration guide (PT-BR).
*   **`docs/en/#12 Theme Engine - OKLch Color Pipeline and Accessibility.md`**: Why built hex values can differ slightly from config (OKLch pipeline); expected behaviour and accessibility benefits (EN).
*   **`docs/pt-br/#12 Theme Engine - Pipeline OKLch e Acessibilidade.md`**: Same content in PT-BR.

---

## ðŸ” Common Questions â†’ Answers

### **"What is the SSOT?"**
Single sources of truth:
- **Token Structure**: `dynamic-themes/schemas/architecture-schema.mjs` (feedback, product, brand)
- **Typography Styles**: `dynamic-themes/schemas/typography-styles-schema.mjs` (structure); content in `config/foundationTypography.config.json` (schema loads it; generator uses schema)
- **Foundation Styles** (elevation): `dynamic-themes/configs/foundations/foundation-styles.shared.mjs`. Each foundation can override via `styles` in its config. See `dynamic-themes/configs/foundations/README.md`.

### **"Where are the tokens generated?"**
*   **Source**: `dynamic-themes/configs/`
*   **Intermediate**: `data/brand/` (Generated JSONs)
*   **Dimension**: `data/dimension/normal.json` is generated from `config/dimension.config.mjs` via `npm run dimension:generate` (or `build:themes`).
*   **Foundations**: `data/foundation/{brand}/` is generated by `foundations:generate` (part of `build:themes`); then `build:all` outputs to `dist/`.
*   **Output**: `dist/` (CSS, JS, MJS, TS)

### **"What does build:themes do?"**
*   Generates **all** theme structures in one go: ensure data â†’ themes (brand) â†’ dimension â†’ sync (mode/surface/semantic/foundation engine) â†’ **foundations** (data/foundation/*) â†’ build all (semantic + foundation + components â†’ dist). Foundations are included.

### **"How do I configure gradients?"**
*   **Full guide (EN):** **`docs/en/#11 Theme Engine - Gradient Configuration.md`** Â· **(PT-BR):** **`docs/pt-br/#11 Theme Engine - ConfiguraÃ§Ã£o de Gradientes.md`** â€“ step-by-step: enable `global.gradients`, set `global.gradientConfig` (degrees, steps, defaultComposites), include `_gradients.json` in brandFiles, run themes:generate then sync:architecture. See also `dynamic-themes/README.md` Â§ Gradients.

### **"Why don't gradients appear in the build output?"**
*   Gradients are emitted only when **`data/semantic/default.json`** has the section **`semantic.color.gradient`**. That section is **not** created by `npm run build`; it is created by **`npm run sync:architecture`**, which propagates gradient structure from `data/brand/*/_brand.json` to mode, surface, and semantic.
*   **Correct order**: `npm run themes:generate` â†’ **`npm run sync:architecture`** â†’ `npm run build`. Or run **`npm run build:themes`** (full pipeline including sync). If you only run `build` after enabling gradients, semantic has no gradient and the build will warn; run sync (or build:themes) then build again. See **`docs/en/#11 Theme Engine - Gradient Configuration.md`** (or pt-br) and `dynamic-themes/README.md` Â§ Gradients.

### **"Which files in data/ must not be deleted or overwritten by scripts?"**
*   **Protected (no auto-generation yet)**: `data/$metadata.json`, `data/$themes.engine.json.template`, `data/$themes.json`. See RULES.md Â§4. Scripts must never remove or overwrite these.

### **"How do I add a new Brand?"**
See `dynamic-themes/README.md` -> "Creating a New Theme".

### **"Why do built hex values differ from the hex declared in config?"**
*   Token colours are decomposed in **OKLch** (perceptually uniform space). The round-trip (hex â†’ OKLch â†’ sRGB â†’ hex) can produce slightly different hex values; this is **expected** and keeps the full palette in one consistent model, which improves **accessibility** and predictable contrast.
*   **Full doc**: **`docs/en/#12 Theme Engine - OKLch Color Pipeline and Accessibility.md`**.

### **"How do components and Figma use tokens? Which layer (Semantic vs Foundation)?"**
*   **Components** always use the **Semantic** layer (the exposed layer); they sometimes use **Foundation** when a suitable alias exists (e.g. `foundation.bg.primary`). Never use raw values or mode/surface/brand in components.
*   **To recognize tokens** (e.g. when reading Figma via MCP): token names starting with `semantic.*` are Semantic; names starting with `foundation.*` are Foundation aliases (they reference Semantic).
*   **Full reference**: **`docs/context/tokens/token-usage-for-components-and-figma.md`**.

---

## ï¿½ ðŸ“ Notes for Agents

### **When Adding New Knowledge**
*   If it's a rule/constraint -> Update `RULES.md`
*   If it's a high-level status -> Update `SUMMARY.md`
*   If it's task-related -> Update `WORK_PLAN.md`

### **When Searching**
Use `AI_CONTEXT.md` as your map. It links to everything else.
